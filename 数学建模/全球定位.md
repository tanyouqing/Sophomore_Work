# 全球定位 

***曹家豪 软件2204 2226114017***               

---

1. 过去如何确认方位？

   - 指南针

   - 经、纬度定位

     用太阳投影长度等确定纬度（相对容易）

     将经度转换为确认时间的问题（在大海上航行存在较大误差）

   - 近代：雷达

---

2. 全球定位系统:              世界现有全球定位系统（卫星定位）：GPS、GLONASS、伽利略、北斗

   ## 卫星定位的**基本模型构建**：

   ### 建模背景：

   1. 每人每时每刻头顶卫星数大概在*6~10*颗
   2. 每颗卫星沿其固定轨道运行，都会向外发送信号
   3. 以地球中心为原点建立x、y、z三维直角坐标系，以此表示位置
   4. 地球上的人可以接受到多组卫星信号包（信息包括卫星的位置、发信号即时时间）
   5. 人自身的坐标通过卫星坐标和人与卫星的距离来确定

   ### 建模过程

   主要通过 建模背景（5）的原理列出方程组，如：

   （x-x<sub>卫星</sub>)<sup>2</sup>+(y-y<sub>卫星</sub>)<sup>2</sup>+(z-z<sub>卫星</sub>)<sup>2</sup>=[(t-t<sub>卫星</sub>)*c] 

   像这样的方程可列出5~10个（由头顶卫星数确定），则可利用消元以及矩阵求解四个未知数，得到人的坐标以及实时时间

   ### 模型分析

   - 误差来源：

   1. 卫星的时钟是否精准，是否同步
   2. 轨道的偏差
   3. 其他：电离层延迟、对流层延迟、接收机噪声

   - 通过方程两边对 t 的求导，求解x、y、z的大致误差

   ### 模型评价

   该模型主要从**科学可行性**解决问题，可以基本满足求解**时间**上的需求（误差较小），但对**空间**（即人的坐标）求解存在较大误差，表现不够精确；距离**工程可行性**仍有技术问题需要解决。

   ### 模型改进

   倘若人的位置是静态的，则可以持续获取卫星坐标，通过傅里叶变换等处理数据减少误差；还有其他地面上的辅助手段可以增加数据参数等。

---

3. 获得数学建模的基本步骤

   ![数学建模步骤](D:\大二作业\微信图片_20240305224828.png)

---

4. 提出问题

   在得到形如 （x-x<sub>卫星</sub>)<sup>2</sup>+(y-y<sub>卫星</sub>)<sup>2</sup>+(z-z<sub>卫星</sub>)<sup>2</sup>=[(t-t<sub>卫星</sub>)*c]  这样的 6~10 组方程后，我们该如何求出其解(x,y,z,t)?

**解答：**

​	在这里我们利用最小二乘思想获得最佳拟合解：

1. **构建残差函数**

   对于第i组方程:

   (x - x<sub>卫星i</sub>)^2 + (y - y<sub>卫星i</sub>)^2 + (z - z<sub>卫星i</sub>)^2 = [(t - t<sub>卫星i</sub>) * c]^2

   我们将右边移项,定义残差r<sub>i</sub>为:

   r<sub>i</sub> = (x - x<sub>卫星i</sub>)^2 + (y - y<sub>卫星i</sub>)^2 + (z - z<sub>卫星i</sub>)^2 - [(t - t<sub>卫星i</sub>) * c]^2

2. **构建代价函数**

   我们的目标是找到(x,y,z,t)使残差的平方和最小，即：

   J = Σ r<sub>i</sub>^2  最小

3. **求解非线性方程组**

   这是一个含有4个未知数的非线性方程组,查阅资料，得知我们可以使用数值优化算法如高斯-牛顿法或Levenberg-Marquardt算法来求解。

   需要给出(x,y,z,t)的一个合理初始猜测值,算法会迭代更新这些值,使代价函数J不断减小,直到收敛到最小值时得到最优解。

- 算法大致逻辑如下：

  1. 定义残差函数res(x,y,z,t)，对于每一组已知卫星位置(x,y,z)和时间t,计算其与未知解(x,y,z,t)的距离残差。

  2. 定义代价函数cost(x,y,z,t)为所有残差的平方和。

  3. 给出(x,y,z,t)的一个合理初始猜测值(x0,y0,z0,t0)。

  4. 使用迭代优化算法如高斯-牛顿法或Levenberg-Marquardt算法: 

     a) 计算当前代价函数值cost(x0,y0,z0,t0)和代价函数对(x,y,z,t)的雅可比矩阵。 

     b) 根据雅可比矩阵和其它额外信息(如Hessi矩阵)计算(x,y,z,t)的步长或修正值(delta_x,delta_y,delta_z,delta_t)。 

     c) 计算新解(x_new,y_new,z_new,t_new) = (x0,y0,z0,t0) + (delta_x,delta_y,delta_z,delta_t)。 

     d) 若新解的代价函数值cost(x_new,y_new,z_new,t_new)小于旧解,则更新(x0,y0,z0,t0)为新解。否则需要适当调整步长等参数,防止发散。 

     e) 重复上述步骤,直到满足终止条件(如迭代次数上限、残差平方和小于阈值等)。

  5. 输出最终解(x0,y0,z0,t0)作为最小二乘解。

4. **几何约束**

   值得注意的是,单纯使用这5组方程,方程组可能无解或有多解。我们需要确保有足够的几何约束,也就是5个卫星的位置需要足够分散,从不同角度对目标点进行观测,这样才能使未知数的解是唯一的。

*通过上述步骤,利用数值优化算法,我们可以解出x,y,z,t的最佳估计值*



